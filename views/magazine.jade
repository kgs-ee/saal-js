extends layout

block vars

block content

    .container-fluid

        .row
            section.event-banner.carousel.slide(id='front-carousel' data-ride='carousel')
                .carousel-inner(role='listbox')
                    - var photoActive = 0
                    each photo in op.get(echo, ['photos'], [{ix: 0, big: {file: '/images/placeholder.jpg'}}])
                        .item(class=(photoActive++ === 0 ? 'active' : ''))
                            figure(id = 'slide-' + photo.ix, style='background-image: url(' + op.get(photo, ['big', 'file'], op.get(photo, ['medium', 'file'], '/images/placeholder.jpg')) + ');')
                            header.col-md-8
                                if op.get(echo, lang + '-supertitle', '')
                                    p= op.get(echo, lang + '-supertitle', '')
                                h1
                                    if op.get(echo, 'author', false)
                                        span.artist= op.get(echo, 'author', []).map(function(a){return a.value}).join(', ')

                                h1= op.get(echo, lang + '-title', '')

                                if op.get(echo, lang + '-subtitle', '')
                                    p= op.get(echo, lang + '-subtitle', '')

                            ul.event-categories
                                each echoCategory in echoCategories
                                    li.text-uppercase.h3(class=(echoCategory.checked ? "" : "unactive"))
                                        span= op.get(echoCategory, [lang+'-name'], t('Jon Doe'))

                if op.get(echo, ['photos'], []).length > 1
                    a.left.carousel-control(href='#front-carousel' role='button' data-slide='prev')
                        span.icon-prev.arrow-left(aria-hidden='true')
                        span.sr-only Previous
                    a.right.carousel-control(href='#front-carousel' role='button' data-slide='next')
                        span.icon-next.arrow-right(aria-hidden='true')
                        span.sr-only Next

                //- Gradient Map for images
                each photo in op.get(echo, ['photos'], [{ix: 0, big: {file: '/images/placeholder.jpg'}}])
                    script.
                        var slide#{photo.ix} = document.getElementById('slide-#{photo.ix}');
                        GradientMaps.applyGradientMap(slide#{photo.ix}, '#{SAAL.secondary_color}, #{SAAL.main_color}'); 

        .row.page-margin

            .col-md-12
                .row

                    .article.col-sm-12.col-md-8.col-lg-8
                        h2= op.get(echo, 'author', []).map(function(a){return a.value}).join(', ')
                        i= moment(op.get(echo, ['date'])).locale(lang).format('L')

                        h2= op.get(echo, [lang + '-title'])
                        p.subtitle= op.get(echo, [lang + '-subtitle'])
                        
                        p!= op.get(echo, [lang + '-contents'])
                        
                        i.signature= op.get(echo, 'author', []).map(function(a){return a.value}).join(', ') + ' @ ' + moment(op.get(echo, ['date'])).locale(lang).format('L')
                    
                    - var postCount = 0
                    .col-sm-12.col-md-4.col-lg-4
                        each yearString in Object.keys(echoArray).sort().reverse()
                            each monthString in Object.keys(op.get(echoArray, [yearString], [])).sort().reverse()
                                each dayString in Object.keys(op.get(echoArray, [yearString, monthString], [])).sort().reverse()
                                    each posting in op.get(echoArray, [yearString, monthString, dayString], [])
                                        if postCount++ < 12
                                            .col-xs-12.col-md-12.col-lg-12
                                                hr
                                            .col-xs-12.col-sm-12.col-lg-12
                                                a(href='./magazine/' + op.get(posting,'id'))
                                                    p= 'Aeg: ' + (moment(op.get(posting, ['date'])).locale(lang).format('L'))
                                                    h3
                                                        if op.get(posting, 'author', []).length
                                                            span.artist= 'Autor: ' + op.get(posting, 'author', []).map(function(a){return a.value}).join(', ')

                                                    span.name= 'Pealkiri: ' + op.get(posting, lang + '-title')

                                                    if op.get(posting, lang + '-subtitle', '')
                                                        span.subtitle= 'Alapealkiri: ' + op.get(posting, lang + '-subtitle', '')

                        .col-xs-12.col-md-12.col-lg-12
                            hr
